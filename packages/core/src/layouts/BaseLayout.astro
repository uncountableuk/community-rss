---
/**
 * Base layout for Community RSS pages.
 *
 * Injects the CSS design token stylesheet and provides a minimal
 * HTML shell. All framework pages extend this layout.
 *
 * Provides named slots for customisation:
 * - `head` — additional `<head>` content (meta tags, scripts)
 * - `header` — replaces the default header/nav (uses fallback content)
 * - `below-header` — extension slot between header and main content
 * - `before-unnamed-slot` — content injected before the default slot
 * - (default) — page content
 * - `after-unnamed-slot` — content injected after the default slot
 * - `footer` — footer section (uses fallback content, empty by default)
 *
 * @since 0.1.0
 */

import AuthButton from '../components/AuthButton.astro';
import ConsentModal from '../components/ConsentModal.astro';

interface Props {
  title: string;
  description?: string;
}

const { title, description = 'Community RSS' } = Astro.props;
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content={description} />
    <title>{title}</title>
    <slot name="head" />
  </head>
  <body>
    <slot name="header">
      <header class="crss-header">
        <nav class="crss-nav">
          <a href="/" class="crss-nav-brand"> Community RSS </a>
          <AuthButton server:defer>
            <div slot="fallback" class="crss-auth-skeleton" aria-hidden="true"></div>
          </AuthButton>
        </nav>
      </header>
    </slot>
    <slot name="below-header" />
    <slot name="before-unnamed-slot" />
    <slot />
    <slot name="after-unnamed-slot" />
    <slot name="footer" />
    <ConsentModal />
  </body>
</html>

<style is:global>
  @import '../styles/layers.css';
  @import '../styles/tokens/reference.css';
  @import '../styles/tokens/system.css';
  @import '../styles/tokens/components.css';

  @layer crss-components {
    .crss-header {
      border-bottom: 1px solid var(--crss-comp-header-border);
      background: var(--crss-comp-header-bg);
    }

    .crss-nav {
      display: flex;
      align-items: center;
      justify-content: space-between;
      max-width: var(--crss-comp-nav-max-width);
      margin: 0 auto;
      padding: var(--crss-sys-space-sm) var(--crss-sys-space-lg);
    }

    .crss-nav-brand {
      font-weight: 700;
      font-size: var(--crss-font-size-lg);
      color: var(--crss-text-primary);
      text-decoration: none;
    }

    .crss-nav-brand:hover {
      color: var(--crss-primary);
    }

    .crss-auth-skeleton {
      width: 80px;
      height: 36px;
      border-radius: var(--crss-radius-md);
      background: var(--crss-surface-2);
    }
  }
</style>
