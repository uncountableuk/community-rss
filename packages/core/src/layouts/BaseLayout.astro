---
/**
 * Base layout for Community RSS pages.
 *
 * Injects the CSS design token stylesheet and provides a minimal
 * HTML shell. All framework pages extend this layout.
 *
 * Provides named slots for customisation:
 * - `head` — additional `<head>` content (meta tags, scripts)
 * - `header` — replaces the default header/nav
 * - `footer` — adds a footer section
 *
 * @since 0.1.0
 */

import AuthButton from '../components/AuthButton.astro';
import ConsentModal from '../components/ConsentModal.astro';

interface Props {
  title: string;
  description?: string;
}

const { title, description = 'Community RSS' } = Astro.props;
const hasHeaderSlot = Astro.slots.has('header');
const hasFooterSlot = Astro.slots.has('footer');
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content={description} />
    <title>{title}</title>
    <slot name="head" />
  </head>
  <body>
    {
      hasHeaderSlot ? (
        <slot name="header" />
      ) : (
        <header class="crss-header">
          <nav class="crss-nav">
            <a href="/" class="crss-nav-brand">
              Community RSS
            </a>
            <AuthButton server:defer>
              <div slot="fallback" class="crss-auth-skeleton" aria-hidden="true" />
            </AuthButton>
          </nav>
        </header>
      )
    }
    <slot />
    {
      hasFooterSlot && (
        <footer class="crss-footer">
          <slot name="footer" />
        </footer>
      )
    }
    <ConsentModal />
  </body>
</html>

<style is:global>
  @import '../styles/layers.css';
  @import '../styles/tokens/reference.css';
  @import '../styles/tokens/system.css';
  @import '../styles/tokens/components.css';

  @layer crss-components {
    .crss-header {
      border-bottom: 1px solid var(--crss-border);
      background: var(--crss-surface-0);
    }

    .crss-nav {
      display: flex;
      align-items: center;
      justify-content: space-between;
      max-width: 1200px;
      margin: 0 auto;
      padding: var(--crss-space-sm) var(--crss-space-lg);
    }

    .crss-nav-brand {
      font-weight: 700;
      font-size: var(--crss-font-size-lg);
      color: var(--crss-text-primary);
      text-decoration: none;
    }

    .crss-nav-brand:hover {
      color: var(--crss-primary);
    }

    .crss-auth-skeleton {
      width: 80px;
      height: 36px;
      border-radius: var(--crss-radius-md);
      background: var(--crss-surface-2);
    }
  }
</style>
