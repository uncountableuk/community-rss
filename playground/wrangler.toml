#:schema node_modules/wrangler/config-schema.json

name = "community-rss-playground"
compatibility_date = "2025-01-01"
compatibility_flags = ["nodejs_compat"]

# Astro on Cloudflare Pages
pages_build_output_dir = "./dist"

# D1 Database
[[d1_databases]]
binding = "DB"
database_name = "community_db"
database_id = "local-dev-db"
migrations_dir = "../packages/core/src/db/migrations"

# R2 Bucket (media caching)
[[r2_buckets]]
binding = "MEDIA_BUCKET"
bucket_name = "community-images"

# Queue (article processing)
[[queues.producers]]
binding = "ARTICLE_QUEUE"
queue = "article-processing"

[[queues.consumers]]
queue = "article-processing"
max_batch_size = 10
max_retries = 3

# Cron Triggers (feed sync every 30 minutes)
[triggers]
crons = ["*/30 * * * *"]
